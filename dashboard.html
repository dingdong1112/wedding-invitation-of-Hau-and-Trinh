<!doctype html>
<html lang="en" data-bs-theme="auto">

<head>
    <!-- Common -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Dashboard Ulems">
    <title>Dashboard Qu·∫£n Tr·ªã</title>

    <!-- Appearance -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#f8f9fa">

    <!-- Font & CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./css/admin.css">

    <!-- JS Dependencies -->
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./dist/admin.js"></script>
</head>

<!-- Thay link Vercel c·ªßa b·∫°n v√†o ƒë√¢y -->

<body data-url="https://wedding-invitation-of-hau-and-chin.vercel.app/">

    <!-- Mobile Nav -->
    <nav class="navbar navbar-expand fixed-bottom rounded-top-4 border-top d-md-none d-lg-none d-xl-none p-0">
        <ul class="navbar-nav nav-justified w-100 align-items-center">
            <li class="nav-item">
                <button class="nav-link active" onclick="undangan.admin.navbar.buttonNavHome(this)">
                    <i class="fa-solid fa-house"></i>
                    <span class="d-block" style="font-size: 0.4rem;">Th·ªëng K√™</span>
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" onclick="undangan.admin.navbar.buttonNavComments(this)">
                    <i class="fa-solid fa-comments"></i>
                    <span class="d-block" style="font-size: 0.4rem;">Qu·∫£n L√Ω L·ªùi Ch√∫c</span>
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" onclick="undangan.admin.navbar.buttonNavSetting(this)">
                    <i class="fa-solid fa-gear"></i>
                    <span class="d-block" style="font-size: 0.4rem;">C√†i ƒê·∫∑t Trang Kh√°ch</span>
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" onclick="undangan.admin.navbar.buttonNavSecurity(this)">
                    <i class="fa-solid fa-user-shield"></i>
                    <span class="d-block" style="font-size: 0.4rem;">B·∫£o M·∫≠t & Token</span>
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link logout" onclick="undangan.admin.logout()">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <span class="d-block" style="font-size: 0.7rem;">Logout</span>
                </button>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="container mt-4 mb-5">
        <!-- Header -->
        <div class="d-none d-sm-flex justify-content-between align-items-center mt-4 mb-5 pt-1">
            <h4 class="m-0 p-0 flex-grow-1 fw-bold">Admin Panel <i class="fa-solid fa-fire text-danger ms-2"></i></h4>
            <div class="m-0 p-0 flex-grow-1 text-end" id="dashboard-name" style="font-size: 1.4rem;">Admin</div>
        </div>

        <div class="row m-0 p-0">
            <!-- MENU TR√ÅI (Desktop) -->
            <div class="col-md-3 d-none d-md-block m-0 p-0">
                <ul class="nav flex-column w-100 nav-pills pe-4" id="admin-tabs" role="tablist">
                    <li class="nav-item pe-2" role="presentation">
                        <button
                            class="btn-theme-auto nav-link w-100 text-start fw-semibold mb-1 rounded-4 shadow-sm active"
                            data-bs-toggle="pill" data-bs-target="#pills-home" id="button-home" type="button" role="tab"
                            aria-controls="pills-home" aria-selected="true">
                            <i class="fa-solid fa-house ms-3 me-2"></i>Th·ªëng K√™
                        </button>
                    </li>
                    <li class="nav-item pe-2" role="presentation">
                        <button class="btn-theme-auto nav-link w-100 text-start fw-semibold mb-1 rounded-4 shadow-sm"
                            data-bs-toggle="pill" data-bs-target="#pills-wishes" id="button-wishes" type="button"
                            role="tab" aria-controls="pills-wishes" aria-selected="true"
                            onclick="undangan.admin.loadWishesManager()">
                            <i class="fa-solid fa-comments ms-3 me-2"></i>Qu·∫£n L√Ω L·ªùi Ch√∫c
                        </button>
                    </li>
                    <!--li class="nav-item pe-2">
                        <button class="btn-theme-auto nav-link w-100 text-start fw-semibold my-1 rounded-4 shadow-sm"
                            data-bs-toggle="pill" data-bs-target="#pills-setting">
                            <i class="fa-solid fa-sliders ms-3 me-2"></i>C√†i ƒê·∫∑t Trang Kh√°ch
                        </button>
                    </li-->
                    <li class="nav-item pe-2" role="presentation">
                        <button class="btn-theme-auto nav-link w-100 text-start fw-semibold my-1 rounded-4 shadow-sm"
                            data-bs-toggle="pill" data-bs-target="#pills-setting" id="button-setting" type="button"
                            role="tab" aria-controls="pills-setting" aria-selected="false">
                            <i class="fa-solid fa-gear ms-3 me-2"></i>C√†i ƒê·∫∑t Trang Kh√°ch
                        </button>
                    </li>
                    <li class="nav-item pe-2">
                        <button class="btn-theme-auto nav-link w-100 text-start fw-semibold my-1 rounded-4 shadow-sm"
                            data-bs-toggle="pill" data-bs-target="#pills-security" id="button-security" type="button"
                            role="tab" aria-controls="pills-security" aria-selected="false">
                            <i class="fa-solid fa-user-shield ms-3 me-2"></i>B·∫£o M·∫≠t & Token
                        </button>
                    </li>
                    <li class="nav-item pe-2">
                        <hr class="my-2">
                    </li>
                    <li class="nav-item pe-2">
                        <button
                            class="btn-theme-auto logout nav-link w-100 text-start fw-semibold mt-1 rounded-4 shadow-sm"
                            onclick="undangan.admin.logout()">
                            <i class="fa-solid fa-right-from-bracket ms-3 me-2"></i>ƒêƒÉng Xu·∫•t
                        </button>
                    </li>
                </ul>
            </div>

            <!-- N·ªòI DUNG PH·∫¢I -->
            <div class="col-md-9 m-0 p-0">
                <div class="tab-content">

                    <!-- 1. HOME -->
                    <section class="tab-pane fade show active" id="pills-home">
                        <div class="rounded-4 p-3 mb-4 shadow bg-body-secondary">
                            <h5 class="fw-bold m-0"><i class="fa-solid fa-home me-2"></i>T·ªïng Quan</h5>
                        </div>

                        <!-- Stats Cards -->
                        <div class="row g-3">
                            <div class="col-6 col-xl-3">
                                <div class="rounded-4 shadow p-3 border-0 text-white" style="background: #8573F1;">
                                    <p class="fw-bold m-0">T·ªïng L·ªùi Ch√∫c</p>
                                    <h3 class="fw-bold m-0" id="count-comment">0</h3>
                                </div>
                            </div>
                            <div class="col-6 col-xl-3">
                                <div class="rounded-4 shadow p-3 border-0 text-white" style="background: #7A5CD9;">
                                    <p class="fw-bold m-0">Tham D·ª±</p>
                                    <h3 class="fw-bold m-0" id="count-present">0</h3>
                                </div>
                            </div>
                            <div class="col-6 col-xl-3">
                                <div class="rounded-4 shadow p-3 border-0 text-white" style="background: #6546B1;">
                                    <p class="fw-bold m-0">V·∫Øng M·∫∑t</p>
                                    <h3 class="fw-bold m-0" id="count-absent">0</h3>
                                </div>
                            </div>
                            <div class="col-6 col-xl-3">
                                <div class="rounded-4 shadow p-3 border-0 text-white" style="background: #4F3392;">
                                    <p class="fw-bold m-0">Th√≠ch</p>
                                    <h3 class="fw-bold m-0" id="count-like">0</h3>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 2. WISHES MANAGER -->
                    <section class="tab-pane fade" id="pills-wishes">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <!-- THANH C√îNG C·ª§ L·ªåC (N√¢ng Cao) -->
                            <div class="card border-0 shadow-sm mb-3 bg-body-tertiary">
                                <div class="card-body p-3">
                                    <!-- D√≤ng 1: T√¨m ki·∫øm & Tr·∫°ng th√°i -->
                                    <div class="row g-3 mb-2">
                                        <div class="col-12 col-md">
                                            <div class="input-group">
                                                <span class="input-group-text border-0 bg-white"><i
                                                        class="fa-solid fa-search text-muted"></i></span>
                                                <input type="text" class="form-control border-0 bg-white shadow-none"
                                                    id="filter-search" placeholder="T√¨m t√™n, n·ªôi dung..."
                                                    oninput="undangan.admin.applyFilters()">
                                            </div>
                                        </div>
                                        <div class="col-12 col-md-auto">
                                            <select class="form-select border-0 bg-white shadow-none"
                                                id="filter-presence" onchange="undangan.admin.applyFilters()">
                                                <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                                <option value="yes">‚úÖ Tham d·ª±</option>
                                                <option value="no">‚ùå V·∫Øng m·∫∑t</option>
                                                <option value="other">‚ùî Kh√°c</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- D√≤ng 2: B·ªô l·ªçc Th·ªùi gian -->
                                    <div class="row g-2 align-items-center mt-1">
                                        <div class="col-12 col-md-auto">
                                            <select
                                                class="form-select form-select-sm border-0 bg-white shadow-none text-primary fw-bold"
                                                id="time-filter-type" onchange="undangan.admin.toggleTimeFilter()">
                                                <option value="none">üïí T·∫•t c·∫£ th·ªùi gian</option>
                                                <option value="month">üìÖ L·ªçc theo Th√°ng</option>
                                                <option value="range">‚Üî L·ªçc theo Kho·∫£ng Ng√†y</option>
                                            </select>
                                        </div>

                                        <!-- Input: Th√°ng & NƒÉm (Thay th·∫ø input month c≈©) -->
                                        <div class="col-12 col-md-auto d-none" id="filter-month-group">
                                            <div class="d-flex gap-2">
                                                <select class="form-select form-select-sm border-0 bg-white shadow-none"
                                                    id="filter-month-val" onchange="undangan.admin.applyFilters()"
                                                    style="width: 80px;">
                                                    <option value="">Th√°ng...</option>
                                                    <option value="01">Th√°ng 1</option>
                                                    <option value="02">Th√°ng 2</option>
                                                    <option value="03">Th√°ng 3</option>
                                                    <option value="04">Th√°ng 4</option>
                                                    <option value="05">Th√°ng 5</option>
                                                    <option value="06">Th√°ng 6</option>
                                                    <option value="07">Th√°ng 7</option>
                                                    <option value="08">Th√°ng 8</option>
                                                    <option value="09">Th√°ng 9</option>
                                                    <option value="10">Th√°ng 10</option>
                                                    <option value="11">Th√°ng 11</option>
                                                    <option value="12">Th√°ng 12</option>
                                                </select>
                                                <select class="form-select form-select-sm border-0 bg-white shadow-none"
                                                    id="filter-year-val" onchange="undangan.admin.applyFilters()"
                                                    style="width: 90px;">
                                                    <option value="2024">2024</option>
                                                    <option value="2025" selected>2025</option>
                                                    <option value="2026">2026</option>
                                                    <option value="2027">2027</option>
                                                    <option value="2028">2028</option>
                                                    <option value="2029">2029</option>
                                                    <option value="2030">2030</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Input: Kho·∫£ng Ng√†y (Xu·ªëng d√≤ng tr√™n mobile) -->
                                        <div class="col-12 col-md-auto d-none" id="filter-range-group">
                                            <div class="d-flex align-items-center gap-2">
                                                <input type="date"
                                                    class="form-control form-control-sm border-0 bg-white shadow-none"
                                                    id="filter-date-start" onchange="undangan.admin.applyFilters()"
                                                    title="T·ª´ ng√†y">
                                                <span class="text-muted">-</span>
                                                <input type="date"
                                                    class="form-control form-control-sm border-0 bg-white shadow-none"
                                                    id="filter-date-end" onchange="undangan.admin.applyFilters()"
                                                    title="ƒê·∫øn ng√†y">
                                            </div>
                                        </div>

                                        <div class="col text-end ms-auto">
                                            <button class="btn btn-light btn-sm rounded-pill px-3 shadow-sm"
                                                onclick="undangan.admin.resetFilters()">
                                                <i class="fa-solid fa-rotate-right me-1"></i> ƒê·∫∑t l·∫°i
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h5 class="fw-bold"><i class="fa-solid fa-comments me-2"></i>Danh S√°ch L·ªùi Ch√∫c</h5>
                            <button class="btn btn-success btn-sm rounded-pill shadow-sm"
                                onclick="undangan.admin.openAddWishModal()">
                                <i class="fa-solid fa-plus me-1"></i>Th√™m M·ªõi
                            </button>
                        </div>
                        <div id="wishes-manager-list" class="d-flex flex-column gap-3"></div>
                        <!-- PH√ÇN TRANG & C√îNG C·ª§ -->
                        <div id="pagination-controls" class="pagination-container d-none">
                            <div class="d-flex align-items-center gap-2">
                                <small class="text-muted">Hi·ªÉn th·ªã:</small>
                                <select class="form-select form-select-sm rounded-3" style="width: 70px;"
                                    id="per-page-select" onchange="undangan.admin.changePerPage(this.value)">
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>

                            <nav>
                                <ul class="pagination pagination-sm mb-0" id="pagination-ul">
                                    <!-- JS s·∫Ω render n√∫t ph√¢n trang v√†o ƒë√¢y -->
                                </ul>
                            </nav>
                        </div>
                    </section>

                    <!-- 3. SETTINGS -->
                    <section class="tab-pane fade" id="pills-setting" role="tabpanel" tabindex="0">
                        <div class="card p-4 shadow-sm rounded-4 border-0 bg-theme-auto">
                            <h5 class="mb-4 fw-bold border-bottom pb-2">ƒêi·ªÅu Khi·ªÉn Giao Di·ªán Kh√°ch</h5>

                            <!-- C√°c n√∫t Switch -->
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="toggle-confetti"
                                    onchange="undangan.admin.updateConfig('confetti_enabled', this.checked)">
                                <label class="form-check-label" for="toggle-confetti">Hi·ªáu ·ª©ng Ph√°o hoa
                                    (Confetti)</label>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="toggle-particles"
                                    onchange="undangan.admin.updateConfig('particle_control_enabled', this.checked)">
                                <label class="form-check-label" for="toggle-particles">Hi·ªÉn th·ªã ƒê≈©a Th·∫ßn (Ch·ªânh hi·ªáu
                                    ·ª©ng)</label>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="toggle-vinyl"
                                    onchange="undangan.admin.updateConfig('vinyl_enabled', this.checked)">
                                <label class="form-check-label" for="toggle-vinyl">Hi·ªáu ·ª©ng ƒêƒ©a Nh·∫°c Quay</label>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="toggle-music"
                                    onchange="undangan.admin.updateConfig('music_enabled', this.checked)">
                                <label class="form-check-label" for="toggle-music">T·ª± ƒë·ªông ph√°t nh·∫°c & Hi·ªÉn th·ªã
                                    Player</label>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="toggle-popup"
                                    onchange="undangan.admin.updateConfig('wishes_popup_enabled', this.checked)">
                                <label class="form-check-label" for="toggle-popup">Popup L·ªùi Ch√∫c Ch·∫°y Ng·∫´u
                                    Nhi√™n</label>
                            </div>
                            <hr>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input bg-danger border-danger" type="checkbox" id="toggle-lock"
                                    onchange="undangan.admin.updateConfig('can_delete', this.checked)">
                                <label class="form-check-label text-danger fw-bold" for="toggle-lock">KH√ìA ch·ª©c nƒÉng G·ª≠i
                                    L·ªùi Ch√∫c (B·∫£o Tr√¨)</label>
                            </div>
                        </div>
                    </section>

                    <!-- 4. SECURITY -->
                    <section class="tab-pane fade" id="pills-security">
                        <div class="p-4 bg-theme-auto mb-3 rounded-4 shadow">
                            <p class="fw-bold border-bottom pb-2"><i class="fa-solid fa-key me-2"></i>Access Key (Token)
                            </p>
                            <div class="input-group mb-3">
                                <input type="password" class="form-control" id="dashboard-accesskey" readonly value="">
                                <button class="btn btn-outline-secondary" type="button"
                                    onclick="window.toggleTokenVisibility()">
                                    <i class="fa-solid fa-eye" id="eye-icon"></i>
                                </button>
                                <button class="btn btn-outline-secondary" type="button" onclick="window.copyToken()">
                                    <i class="fa-solid fa-copy"></i>
                                </button>
                            </div>
                            <div class="text-end">
                                <button class="btn btn-warning btn-sm rounded-pill shadow-sm"
                                    onclick="window.regenerateToken()">
                                    <i class="fa-solid fa-rotate me-1"></i> T·∫°o Token M·ªõi
                                </button>
                            </div>
                        </div>

                        <div class="p-4 bg-theme-auto mb-3 rounded-4 shadow">
                            <p class="fw-bold border-bottom pb-2"><i class="fa-solid fa-lock me-2"></i>ƒê·ªïi M·∫≠t Kh·∫©u
                                Admin</p>
                            <div class="mb-3">
                                <label class="form-label small text-muted">M·∫≠t kh·∫©u c≈©</label>
                                <input type="password" class="form-control rounded-4" id="old_password">
                            </div>
                            <div class="mb-3">
                                <label class="form-label small text-muted">M·∫≠t kh·∫©u m·ªõi</label>
                                <input type="password" class="form-control rounded-4" id="new_password">
                            </div>
                            <div class="text-end">
                                <button class="btn btn-primary btn-sm rounded-pill shadow-sm"
                                    onclick="undangan.admin.changePassword(this)">
                                    L∆∞u M·∫≠t Kh·∫©u
                                </button>
                            </div>
                        </div>
                    </section>

                </div>
            </div>
        </div>
    </main>

    <!-- MODAL LOGIN -->
    <div class="modal fade" id="mainModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4 shadow-lg">
                <div class="modal-body p-4">
                    <h4 class="text-center fw-bold mb-4">ƒêƒÉng Nh·∫≠p Admin</h4>
                    <form id="admin-login-form"
                        onsubmit="event.preventDefault(); undangan.admin.auth.login(this.querySelector('button[type=submit]'))">
                        <div class="mb-4">
                            <label for="admin-pass" class="form-label fw-bold">M·∫≠t kh·∫©u</label>
                            <input type="password" class="form-control form-control-lg rounded-4" id="admin-pass"
                                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg rounded-4 fw-bold">Login</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL S·ª¨A/TH√äM L·ªúI CH√öC -->
    <div class="modal fade" id="editWishModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4">
                <div class="modal-header border-0">
                    <h5 class="modal-title fw-bold">Th√¥ng Tin L·ªùi Ch√∫c</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="edit-wish-id">
                    <div class="mb-3">
                        <label class="form-label small text-muted">T√™n Kh√°ch</label>
                        <input type="text" class="form-control rounded-4" id="edit-wish-name">
                    </div>
                    <div class="mb-3">
                        <label class="form-label small text-muted">L·ªùi Ch√∫c</label>
                        <textarea class="form-control rounded-4" id="edit-wish-msg" rows="4"></textarea>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-primary rounded-pill px-4"
                        onclick="undangan.admin.saveWish()">L∆∞u L·∫°i</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Xem Chi Ti·∫øt L·ªùi Ch√∫c -->
    <div class="modal fade" id="viewWishModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4 border-0 shadow-lg">
                <div class="modal-header border-0 pb-0">
                    <h5 class="modal-title fw-bold">Chi Ti·∫øt L·ªùi Ch√∫c</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="bg-light rounded-circle p-3 me-3">
                            <i class="fa-solid fa-user fa-xl text-secondary"></i>
                        </div>
                        <div>
                            <h5 class="fw-bold mb-0" id="view-wish-name">T√™n Kh√°ch</h5>
                            <small class="text-muted" id="view-wish-time">Th·ªùi gian</small>
                            <div id="view-wish-presence" class="mt-1"></div>
                        </div>
                    </div>
                    <div class="p-3 bg-light rounded-3">
                        <p class="mb-0" id="view-wish-msg"
                            style="white-space: pre-wrap; font-size: 1rem; line-height: 1.6;"></p>
                    </div>
                </div>
                <div class="modal-footer border-0 pt-0">
                    <button type="button" class="btn btn-secondary rounded-pill px-4"
                        data-bs-dismiss="modal">ƒê√≥ng</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>