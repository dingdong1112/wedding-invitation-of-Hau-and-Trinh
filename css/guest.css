@import url("common.css");
@import url("animation.css");

html {
  scrollbar-width: none !important;
  -ms-overflow-style: none !important;
}

.with-scrollbar {
  scrollbar-width: auto !important;
  -ms-overflow-style: auto !important;
}

.font-esthetic {
  font-family: 'Dancing Script', cursive !important;
}

.font-esthetic2 {
  font-family: 'Sacramento', cursive !important;
}

.font-arabic {
  font-family: 'Noto Naskh Arabic', serif !important;
}

.img-center-crop {
  width: 13rem;
  height: 13rem;
  max-width: 100%;
  max-height: 100%;
  object-fit: cover;
}

html[data-bs-theme="dark"] .btn-transparent {
  background-color: rgba(var(--bs-dark-rgb), 0.5) !important;
  backdrop-filter: blur(0.5rem);
}

html[data-bs-theme="light"] .btn-transparent {
  background-color: rgba(var(--bs-light-rgb), 0.5) !important;
  backdrop-filter: blur(0.5rem);
}

.loading-page {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  /*z-index: 1056;*/
}

html[data-bs-theme="light"] .color-theme-svg {
  color: rgb(255, 255, 255);
  background-color: var(--bs-light);
}

html[data-bs-theme="dark"] .color-theme-svg {
  color: rgb(0, 0, 0);
  background-color: var(--bs-dark);
}

html[data-bs-theme="light"] .bg-light-dark {
  background-color: rgb(var(--bs-light-rgb));
}

html[data-bs-theme="dark"] .bg-light-dark {
  background-color: rgb(var(--bs-dark-rgb));
}

html[data-bs-theme="light"] .bg-white-black {
  background-color: rgb(var(--bs-white-rgb));
}

html[data-bs-theme="dark"] .bg-white-black {
  background-color: rgb(var(--bs-black-rgb));
}

.bg-cover-home {
  width: 100%;
  height: 100%;
  object-fit: cover;
  mask-image: linear-gradient(0.5turn, transparent, black 40%, black 60%, transparent);
}

.width-loading {
  width: 25%;
}

.cursor-pointer {
  cursor: pointer;
}

@media screen and (max-width: 992px) {
  .width-loading {
    width: 50%;
  }
}

@media screen and (max-width: 576px) {
  .width-loading {
    width: 75%;
  }
}

svg {
  display: block;
  line-height: 0;
  shape-rendering: geometricPrecision;
  backface-visibility: hidden;
}

.svg-wrapper {
  overflow: hidden !important;
  transform: translateZ(0) !important;
}

.no-gap-bottom {
  margin-bottom: -0.75rem !important;
}

/* --- BẮT ĐẦU CODE HIỆU ỨNG GỢN SÓNG --- */

/* 1. Định nghĩa chuyển động lên-xuống */
/* 1. Keyframes Animation (Giữ nguyên) */
@keyframes wavy {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

/* 2. Style cho cả cụm từ (Giữ nguyên) */
.wavy-text {
  display: flex;
  justify-content: center;
  font-family: 'Dancing Script', 'Esthetic', sans-serif;
  font-size: 2.5rem;
  margin: 1.5rem 0;
  
  /* Hiệu ứng phản chiếu (Box Reflect) */
  /* Lưu ý: Hiệu ứng này chủ yếu chạy tốt trên Chrome/Safari */
  -webkit-box-reflect: below -15px linear-gradient(transparent, rgba(0, 0, 0, 0.2));
}

/* 3. Style cho từng ký tự (ĐÃ SỬA MÀU SẮC) */
.wavy-text span {
  position: relative;
  display: inline-block;
  
  /* --- SỬA Ở ĐÂY --- */
  /* Mặc định (Light Mode) là màu ĐỎ */
  color: indianred; 
  /* ---------------- */

  animation: wavy 2.5s ease-in-out infinite;
  animation-delay: calc(0.1s * var(--i));
}

/* --- THÊM ĐOẠN NÀY: CẤU HÌNH DARK MODE --- */
/* Khi bật chế độ tối -> Chuyển thành màu TRẮNG */
body.dark-mode .wavy-text span,
[data-bs-theme="dark"] .wavy-text span,
[data-theme="dark"] .wavy-text span {
    color: #ffffff !important;
    /* Thêm chút bóng sáng (Glow) cho đẹp trên nền đen */
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

/* 4. Gán độ trễ (Giữ nguyên phần đếm số thứ tự) */
.wavy-text span:nth-child(1) { --i: 1; }
.wavy-text span:nth-child(2) { --i: 2; }
.wavy-text span:nth-child(3) { --i: 3; }
.wavy-text span:nth-child(4) { --i: 4; }
.wavy-text span:nth-child(5) { --i: 5; }
.wavy-text span:nth-child(6) { --i: 6; }
.wavy-text span:nth-child(7) { --i: 7; }
.wavy-text span:nth-child(8) { --i: 8; }
.wavy-text span:nth-child(9) { --i: 9; }
.wavy-text span:nth-child(10) { --i: 10; }
.wavy-text span:nth-child(11) { --i: 11; }
.wavy-text span:nth-child(12) { --i: 12; }
.wavy-text span:nth-child(13) { --i: 13; }
.wavy-text span:nth-child(14) { --i: 14; }
.wavy-text span:nth-child(15) { --i: 15; }
.wavy-text span:nth-child(16) { --i: 16; }
.wavy-text span:nth-child(17) { --i: 17; }
.wavy-text span:nth-child(18) { --i: 18; }
.wavy-text span:nth-child(19) { --i: 19; }
.wavy-text span:nth-child(20) { --i: 20; }
/* --- KẾT THÚC CODE HIỆU ỨNG GỢN SÓNG --- */

/* --- CSS CHO VIDEO YOUTUBE RESPONSIVE --- */
.video-container {
  position: relative;
  overflow: hidden;
  width: 100%;
  padding-top: 56.25%;
  /* Tỷ lệ 16:9 (chiều cao / chiều rộng) */
}

.video-container iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: none;
}

/* --- CSS CHO NÚT ÂM THANH VIDEO --- */
.video-wrapper #volume-toggle {
  position: absolute;
  bottom: 10px;
  right: 10px;
  z-index: 10;
  width: 35px;
  height: 35px;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* --- CSS CHO NÚT NHẠC CỐ ĐỊNH --- */
#floating-music-button-wrapper {
  position: fixed;
  /* Giữ nút cố định trên màn hình */
  top: 20px;
  /* Cách lề trên 20px */
  right: 20px;
  /* Cách lề phải 20px */
  z-index: 1031;
  /* Đảm bảo nó nổi lên trên các thành phần khác */
}

#floating-music-button-wrapper #button-music {
  width: 40px;
  /* Tăng kích thước nút cho dễ bấm */
  height: 40px;
  font-size: 1.1rem;
  /* Tăng kích thước icon bên trong */
  display: flex;
  justify-content: center;
  align-items: center;
}

/* --- CSS CHO BẢNG ĐIỀU KHIỂN HIỆU ỨNG RƠI --- */
#particle-controller {
  position: fixed;
  top: 70px;
  /* Nằm ngay dưới nút nhạc */
  right: 20px;
  z-index: 1030;
}

#particle-toggle-button {
  width: 40px;
  height: 40px;
  font-size: 1.1rem;
  display: flex;
  justify-content: center;
  align-items: center;
}

#particle-controls {
  display: none;
  /* Ẩn bảng điều khiển mặc định */
  position: absolute;
  top: 50px;
  right: 0;
  width: 220px;
  padding: 15px;
  background-color: var(--bs-body-bg);
  /* Tự động đổi màu theo theme */
  opacity: 0;
  transform: translateY(-10px) scale(0.95);
  transition: opacity 0.2s ease, transform 0.2s ease;
  pointer-events: none;
}

#particle-controls.show {
  display: block;
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

#particle-controls .control-group {
  margin-bottom: 10px;
}

#particle-controls .control-group label {
  font-size: 0.8rem;
  margin-bottom: 5px;
}

/* --- CSS CHO ĐĨA THAN --- */

/* 1. Khung bao ngoài */
.vinyl-wrapper {
  position: relative;
  width: 14rem;
  /* Kích thước đĩa */
  height: 14rem;
  z-index: 10;
}

/* 2. Đĩa nhạc (Phần sẽ xoay) */
.vinyl-disk {
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 4px solid #1a1a1a;
  /* Viền đen giống đĩa than */
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  overflow: hidden;
  /* Mặc định là dừng */
  animation: spinVinyl 8s linear infinite;
  animation-play-state: paused;
  transition: transform 0.5s ease;
}

/* 3. Lỗ tròn ở giữa */
.vinyl-hole {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 20px;
  height: 20px;
  background-color: #1a1a1a;
  /* Màu lỗ đen */
  border: 2px solid #fff;
  /* Viền trắng nhỏ */
  border-radius: 50%;
  z-index: 5;
  pointer-events: none;
}

/* 4. Vân đĩa than (Tạo cảm giác nhựa bóng) */
.vinyl-grooves {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 50%;
  background: repeating-radial-gradient(#0000 0 4px,
      #00000010 5px 6px);
  pointer-events: none;
  z-index: 4;
}

/* 5. Cây kim (Tonearm) */
.vinyl-needle {
  position: absolute;
  top: -30px;
  right: -30px;
  width: 100px;
  height: 100px;
  z-index: 20;
  transform-origin: 90px 10px;
  /* Xoay quanh trục góc trên phải */
  transform: rotate(-45deg);
  /* Trạng thái nghỉ (gác kim ra ngoài) */
  transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
  /* Để không che nút bấm vào ảnh */
  filter: drop-shadow(2px 5px 2px rgba(0, 0, 0, 0.3));
}

/* --- TRẠNG THÁI KHI NHẠC CHẠY --- */
.vinyl-wrapper.is-playing .vinyl-disk {
  animation-play-state: running;
  /* Đĩa quay */
}

.vinyl-wrapper.is-playing .vinyl-needle {
  transform: rotate(15deg);
  /* Tăng góc quay để kim vào sâu hơn */
}

/* Animation xoay tròn */
@keyframes spinVinyl {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

/* --- MUSIC PLAYER STYLES --- */
.music-widget {
  position: fixed;
  top: 20px;
  right: 20px;
  /*z-index: 9999;*/
  display: flex;
  flex-direction: column;
  align-items: flex-end;
}

/* Nút tròn xoay lúc thu gọn */
.btn-main-control {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background: rgba(33, 37, 41, 0.9);
  /* Màu đen mờ */
  color: white;
  border: 2px solid rgba(255, 255, 255, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  cursor: pointer;
  transition: all 0.3s;
  backdrop-filter: blur(5px);
}

.btn-main-control:hover {
  transform: scale(1.1);
  background: black;
}

.spin-slow {
  animation: spinVinyl 4s linear infinite;
}

/* Bảng điều khiển chính */
.music-panel {
  background: rgba(33, 37, 41, 0.95);
  backdrop-filter: blur(10px);
  padding: 15px;
  border-radius: 20px;
  /* Bo góc siêu mịn */
  width: 220px;
  margin-top: 10px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: white;
  transform-origin: top right;
  animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes popIn {
  from {
    opacity: 0;
    transform: scale(0.8) translateY(-10px);
  }

  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Chữ chạy */
.music-info {
  white-space: nowrap;
  overflow: hidden;
  font-size: 0.85rem;
  text-align: center;
  color: #ddd;
}

/* Nút bấm điều khiển */
.btn-control {
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  transition: 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-control.main {
  width: 40px;
  height: 40px;
  background: white;
  color: black;
  border-radius: 50%;
  font-size: 1rem;
}

.btn-control.small {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  font-size: 0.8rem;
}

.btn-control:hover {
  opacity: 0.8;
  transform: scale(1.05);
}

/* Thanh volume */
.volume-slider {
  width: 80px;
  height: 4px;
  border-radius: 5px;
  accent-color: white;
  /* Màu thanh kéo */
}

/* Danh sách phát */
.playlist-box {
  max-height: 150px;
  overflow-y: auto;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 10px;
}

.playlist-item {
  background: transparent !important;
  color: #ccc !important;
  font-size: 0.8rem;
  cursor: pointer;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
}

.playlist-item:hover,
.playlist-item.active {
  background: rgba(255, 255, 255, 0.1) !important;
  color: white !important;
  font-weight: bold;
}

/* Ẩn scrollbar */
.playlist-box::-webkit-scrollbar {
  width: 4px;
}

.playlist-box::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 4px;
}

/* --- CSS NÂNG CAO CHO PLAYER --- */

/* Trạng thái nút đang BẬT (Active) */
.btn-control.active {
  color: #ff4081 !important;
  /* Màu hồng/đỏ nổi bật */
  background: rgba(255, 255, 255, 0.2);
  font-weight: bold;
}

/* Xử lý nút Loop khi ở chế độ "Lặp 1 bài" */
.btn-control.loop-one {
  color: #ff4081 !important;
  position: relative;
}

/* Tạo số 1 nhỏ xíu nằm trên nút Loop */
.btn-control.loop-one::after {
  content: '1';
  position: absolute;
  font-size: 0.6rem;
  font-weight: 900;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #ff4081;
  color: white;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2;
}

/* --- CSS POPUP LỜI CHÚC (BẢN CHUẨN ĐÃ FIX) --- */

/* Áp dụng chung cho CẢ Desktop và Mobile */
.wish-box {
  position: fixed;
  top: 80px;
  /* Cách đỉnh 80px */
  right: 20px;
  width: 320px;

  /* TRẠNG THÁI MẶC ĐỊNH: MỜ ẢO (GLASSMORPHISM) */
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);

  border: 1px solid rgba(255, 255, 255, 0.2);
  border-left: 4px solid #ff4081;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
  color: rgba(0, 0, 0, 0.6);

  padding: 12px;
  display: flex;
  align-items: flex-start;
  /*  z-index: 9998;*/

  /* --- FIX LỖI KẸT & CHUYỂN ĐỘNG --- */
  opacity: 0;
  transform: translateX(120%);
  /* Đẩy xa hẳn ra ngoài (120%) */

  /* Tách riêng transition */
  transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1),
    opacity 0.6s ease,
    background 0.3s ease,
    box-shadow 0.3s ease,
    backdrop-filter 0.3s ease,
    color 0.3s ease;

  pointer-events: none;
  will-change: transform, opacity;
}

/* KHI HIỆN RA (VẪN GIỮ TRẠNG THÁI MỜ) */
.wish-box.show {
  opacity: 0.7;
  /* Chỉ hiện mờ 70% */
  transform: translateX(0);
  /* Trượt vào */
  pointer-events: auto;
  /* Cho phép tương tác */
}

/* --- TRẠNG THÁI RÕ NÉT (KHI HOVER HOẶC CHẠM) --- */
/* .is-hovered dùng cho JS thêm vào khi rê chuột */
/* .is-touched dùng cho JS thêm vào khi chạm tay */
.wish-box:hover,
.wish-box.is-touched,
.wish-box.is-hovered {
  background: rgba(255, 255, 255, 0.95) !important;
  /* Nền trắng đục */
  opacity: 1 !important;
  /* Rõ nét 100% */
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
  backdrop-filter: blur(10px);
  color: #000 !important;
  /* Chữ đen rõ */
  cursor: default;
}

/* Style cho Avatar */
.wish-avatar {
  width: 40px;
  height: 40px;
  background: rgba(255, 240, 245, 0.8);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  margin-right: 12px;
  flex-shrink: 0;
}

/* Style cho Tên và Nội dung */
.wish-content h5 {
  margin: 0 0 5px 0;
  font-size: 0.95rem;
  font-weight: bold;
  color: inherit;
  /* Ăn theo màu cha */
  font-family: 'Josefin Sans', sans-serif;
}

.wish-content p {
  margin: 0;
  font-size: 0.85rem;
  color: inherit;
  /* Ăn theo màu cha */
  line-height: 1.4;
}

/* RIÊNG CHO MOBILE: CHỈNH LẠI KÍCH THƯỚC */
@media screen and (max-width: 576px) {
  .wish-box {
    width: auto;
    /* Tự động co giãn */
    left: 20px;
    right: 20px;
    top: 70px;
  }
}

/* --- CSS NÚT BẬT/TẮT LỜI CHÚC --- */
#wishes-toggle-button {
  width: 40px;
  height: 40px;
  font-size: 1.1rem;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.3s ease;
  color: #666;
  /* Màu mặc định khi tắt */
}

#wishes-toggle-button.active {
  background-color: #ff4081 !important;
  /* Nền hồng khi bật */
  color: white !important;
  /* Chữ trắng khi bật */
  border-color: #ff4081 !important;
  box-shadow: 0 0 10px rgba(255, 64, 129, 0.5) !important;
}

/* Điều chỉnh vị trí cho cả cụm nút bên phải */
#particle-controller {
  position: fixed;
  top: 70px;
  /* Vị trí so với đỉnh */
  right: 20px;
  /*z-index: 1000;*/
  display: flex;
  flex-direction: column;
  align-items: flex-end;

  /* THÊM DÒNG NÀY ĐỂ TẠO KHOẢNG CÁCH ĐỀU */
  gap: 15px;
}

/* --- THANH CÔNG CỤ BÊN PHẢI --- */
#right-toolbar {
  /* Vị trí đã set inline trong HTML, ở đây chỉ xử lý hiển thị */
  pointer-events: none;
  /* Để click xuyên qua vùng trống */
}

#right-toolbar button,
#right-toolbar .control-group {
  pointer-events: auto;
  /* Bật lại click cho nút và bảng */
}

/* Ẩn hiện mượt mà */
.d-none {
  display: none
}

/* Fix lỗi thumbnails cách xa nhau */
#detail-thumbnails img {
  transition: all 0.3s ease;
}

#book {
  width: 100%;
  height: 100%;
}

.my-page img {
  user-select: none;
  pointer-events: none;
}

#album-thumbnail img {
  transition: transform 0.3s ease;
}

#album-thumbnail:hover img {
  transform: scale(1.05);
}

#detail-fullscreen-image {
  touch-action: none;
}

#book-container {
  max-width: 95vw;
  max-height: 80vh;
}

#page-indicator {
  font-size: 0.85rem;
}

/* Style cho thumbnail trong detail modal */
.thumb-item {
  width: 60px;
  height: 60px;
  object-fit: cover;
  opacity: 0.6;
  border-radius: 8px;
  margin: 0 4px;
  cursor: pointer;
  transition: all 0.2s;
  border: 2px solid transparent;
}

.thumb-item.active {
  opacity: 1;
  border-color: #ff4081;
  transform: scale(1.1);
}

/* Icon zoom indicator trên trang sách */
.zoom-indicator {
  position: absolute;
  bottom: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.4);
  color: white;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s;
  pointer-events: none;
  /* Để click xuyên qua */
}

/* Hiện icon khi hover chuột (desktop) hoặc luôn hiện mờ (mobile nếu cần) */
.my-page:hover .zoom-indicator {
  opacity: 1;
}

/* Đảm bảo backdrop không bao giờ che nút đóng nếu bị lỗi */
.modal-backdrop {
  z-index: 1040 !important;
  /* Mặc định bootstrap */
}

.modal {
  z-index: 1055 !important;
  /* Cao hơn backdrop */
}

/* Fix lỗi màn hình đen chết chóc:
   Nếu không có modal nào có class .show, ẩn luôn backdrop đi */
body:not(.modal-open) .modal-backdrop {
  display: none !important;
}

/* Khi body KHÔNG có class modal-open thì bắt buộc phải scroll được */
body:not(.modal-open) {
  overflow: auto !important;
  height: auto !important;
  padding-right: 0 !important;
}

body.modal-open {
  overflow: hidden !important;
  height: 100vh;
  /* Giúp khóa chặt trên iOS */
}

/* --- 1. MAIN TRIGGER STYLES --- */
.main-story-trigger {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.main-story-trigger:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25) !important;
}

.main-story-trigger:hover img {
  transform: scale(1.05);
}

/* Nút Play rung động */
.btn-play-pulse {
  width: 60px;
  height: 60px;
  background: rgba(205, 92, 92, 0.9);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: pulse-red 2s infinite;
}

@keyframes pulse-red {
  0% {
    box-shadow: 0 0 0 0 rgba(205, 92, 92, 0.7);
  }

  70% {
    box-shadow: 0 0 0 20px rgba(205, 92, 92, 0);
  }

  100% {
    box-shadow: 0 0 0 0 rgba(205, 92, 92, 0);
  }
}

/* --- 2. TIMELINE MODAL STYLES --- */
.story-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(18, 18, 18, 0.98);
  z-index: 9990;
  opacity: 0;
  visibility: hidden;
  transition: all 0.4s ease;

  /* Cho phép cuộn dọc */
  overflow-y: auto;

  /* QUAN TRỌNG: Ngăn chặn cuộn lan ra body khi hết trang */
  overscroll-behavior: contain;
  pointer-events: none;
}

.story-modal.active {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

.close-modal-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  font-size: 1.2rem;
  z-index: 9992;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.close-modal-btn:hover {
  background: indianred;
  border-color: indianred;
  transform: rotate(90deg);
}

/* --- 3. TIMELINE LAYOUT (ZIGZAG & CENTER) --- */
.timeline-centered {
  position: relative;
  width: 100%;
  max-width: 1000px;
  margin: 0 auto;
  padding: 0;
}

/* Đường kẻ dọc nối xuyên suốt */
.timeline-line {
  position: absolute;
  top: 50px;
  bottom: 50px;
  left: 50%;
  width: 4px;
  background: rgba(255, 255, 255, 0.15);
  transform: translateX(-50%);
  border-radius: 2px;
  z-index: 0;  
}

/* Phần Center (Trailer & Wedding) */
.timeline-section-center {
  position: relative;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 2;
  margin-bottom: 60px;
}

.timeline-section-center.start-node {
  margin-bottom: 80px;
}

/* Phần Zigzag (Các tập) */
.timeline-row {
  display: flex;
  width: 100%;
  margin-bottom: 60px;
  position: relative;
  z-index: 2;
}

.timeline-item {
  width: 50%;
  position: relative;
  padding: 0 50px;
  /* Khoảng cách từ nội dung đến đường kẻ */
}

/* Định vị Trái - Phải */
.item-left {
  left: 0;
  text-align: right;
  display: flex;
  justify-content: flex-end;
}

.item-left .timeline-content {
  text-align: left;
}

/* Reset text align cho card */
.item-right {
  left: 50%;
  text-align: left;
  display: flex;
  justify-content: flex-start;
}

/* Dấu chấm (Dot) */
.timeline-dot {
  position: absolute;
  top: 30px;
  width: 20px;
  height: 20px;
  background: #222;
  border: 4px solid indianred;
  border-radius: 50%;
  z-index: 10;
  transition: all 0.5s ease;
  transform: scale(0);
  /* Mặc định ẩn */
}

.item-left .timeline-dot {
  right: -10px;
}

.item-right .timeline-dot {
  left: -10px;
}

/* Trái tim kết thúc */
.final-heart-icon {
  width: 50px;
  height: 50px;
  background: indianred;
  border: 3px solid #fff;
  border-radius: 50%;
  color: white;

  /* Dùng Flexbox để căn icon trái tim nhỏ vào giữa hình tròn */
  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 1.5rem;
  z-index: 10;

  /* QUAN TRỌNG: Lệnh này ép buộc khối này ra giữa màn hình */
  margin: 0 auto 20px auto !important;

  box-shadow: 0 0 15px rgba(205, 92, 92, 0.6);
}

/* --- 4. CARD & THUMBNAIL STYLES --- */
.video-thumbnail-wrapper {
  position: relative;
  cursor: pointer;
  overflow: hidden;
  padding-top: 56.25%;
  /* 16:9 Aspect Ratio */
}

.video-thumbnail-wrapper img {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.video-thumbnail-wrapper:hover img {
  transform: scale(1.1);
}

.play-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 50px;
  height: 50px;
  background: rgba(0, 0, 0, 0.6);
  border-radius: 50%;
  border: 2px solid #fff;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.video-thumbnail-wrapper:hover .play-icon {
  background: indianred;
  border-color: indianred;
  transform: translate(-50%, -50%) scale(1.1);
}

/* Áp dụng animation mới này cho nút play */
.play-icon.heart-beat {
  /* Sử dụng animation mới đã bao gồm lệnh căn giữa */
  animation: pulse-heart-centered 1.5s infinite;

  /* Đảm bảo vị trí gốc là ở giữa */
  top: 50%;
  left: 50%;
  /* Không cần transform ở đây nữa vì đã có trong animation, 
       nhưng cứ để transform gốc để phòng khi animation chưa chạy */
  transform: translate(-50%, -50%);
}

.date-badge {
  display: inline-block;
  padding: 4px 12px;
  color: white;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: bold;
  margin-bottom: 10px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* --- 5. ANIMATION (SCROLL REVEAL) --- */
.scroll-reveal {
  opacity: 0;
  transform: translateY(60px);
  transition: all 0.8s cubic-bezier(0.25, 1, 0.5, 1);
}

/* Khi có class visible */
.visible .scroll-reveal {
  opacity: 1;
  transform: translateY(0);
}

.visible .timeline-dot {
  transform: scale(1.2);
}

.visible .final-heart-icon {
  transform: scale(1);
  animation: pulse-heart 1.5s infinite;
}

@keyframes pulse-heart {
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(1.15);
  }

  100% {
    transform: scale(1);
  }
}

/* Định nghĩa lại Animation riêng cho nút Play ở giữa */
@keyframes pulse-heart-centered {
  0% {
    transform: translate(-50%, -50%) scale(1);
  }

  50% {
    transform: translate(-50%, -50%) scale(1.15);
    /* Phóng to nhưng vẫn giữ căn giữa */
  }

  100% {
    transform: translate(-50%, -50%) scale(1);
  }
}

/* --- 6. VIDEO PLAYER MODAL --- */
.video-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9995;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: all 0.3s ease;
}

.video-modal.active {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

.video-modal-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(5px);
}

.video-modal-content {
  position: relative;
  width: 90%;
  max-width: 900px;
  background: #000;
  z-index: 9996;
  transform: scale(0.95);
  transition: transform 0.3s ease;
}

.video-modal.active .video-modal-content {
  transform: scale(1);
}

/* --- STYLE CHO MARKER MỞ ĐẦU (TRAILER) --- */
.start-icon-marker {
  width: 50px;
  height: 50px;
  background: #212529;
  /* Màu tối Cinematic */
  border: 3px solid #fff;
  border-radius: 50%;
  color: white;

  /* Căn giữa icon bên trong */
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  z-index: 10;

  /* Căn giữa màn hình (Desktop) */
  margin: 0 auto 10px auto;
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
}

/* Hiệu ứng khi hiện ra */
.visible .start-icon-marker {
  transform: scale(1.1);
}

/* --- 7. RESPONSIVE (MOBILE) --- */
/* --- MOBILE RESPONSIVE FIX (FINAL V2) --- */
@media (max-width: 768px) {

   .wavy-text {
        font-size: 1.5rem !important; /* Trên điện thoại thu nhỏ còn 1.5rem */
        flex-wrap: wrap; /* Nếu tên quá dài, cho phép rớt dòng */
        margin: 1rem 0;
    }
    
    /* Điều chỉnh khoảng cách các chữ cái trên mobile cho đỡ thưa */
    .wavy-text span {
        margin: 0 1px; 
    }

  /* 1. Dời đường kẻ sang trái */
  .timeline-line {
    left: 30px;
    top: 0;
  }

  /* 2. Cấu hình chung Item */
  .timeline-item {
    width: 100%;
    left: 0 !important;
    padding-left: 70px;
    padding-right: 15px;
    text-align: left;
    justify-content: flex-start;
  }

  /* 3. Dot tròn các tập */
  .item-left .timeline-dot,
  .item-right .timeline-dot {
    left: 22px;
    right: auto;
  }

  /* --- 4. CẤU HÌNH CHUNG CHO TRAILER & ENDING --- */
  .timeline-section-center {
    align-items: flex-start !important;
    padding-left: 70px;
    padding-right: 15px;
    margin-bottom: 50px;
    position: relative;
  }

  .timeline-section-center .card {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
  }

  .badge-wrapper {
    text-align: left;
    width: 100%;
  }

  /* --- 5. XỬ LÝ VỊ TRÍ MARKER (CẢ ĐẦU VÀ CUỐI) --- */
  /* Logic: Left = 30px(line) + 2px(tâm) - 25px(nửa icon) = 7px */

  .start-icon-marker,
  .final-heart-icon {
    position: absolute !important;
    left: 7px !important;
    top: 0;
    margin: 0 !important;
    transform: scale(1);
  }

  /* Animation giữ nguyên vị trí */
  .visible .start-icon-marker,
  .visible .final-heart-icon {
    position: absolute !important;
    left: 7px !important;
    margin-bottom: 0 !important;
  }

  /* Riêng tim đỏ thì có nhịp đập */
  .visible .final-heart-icon {
    animation: pulse-heart 1.5s infinite;
  }
}

/* --- FIX LỖI DARK MODE CHO THIỆP MỜI --- */
/* --- ADAPTIVE CARD: TỰ ĐỔI MÀU THEO CHẾ ĐỘ SÁNG/TỐI --- */

/* 1. CHẾ ĐỘ SÁNG (Mặc định) - Nền Kem, Chữ Đen */
.invitation-card {
  background-color: #fffcf5 !important;
  /* Màu kem sữa dịu mắt */
  color: #444444 !important;
  border: 1px solid #e8e0cc !important;
  transition: all 0.3s ease;
  /* Hiệu ứng chuyển màu mượt mà */
}

.invitation-card .btn {
    color: #333333 !important;
    border-color: #333333 !important;
}

.invitation-card .btn:hover {
    background-color: #333333 !important;
    color: #ffffff !important; /* Di chuột vào thì chữ trắng nền đen */
}


/* 2. CHẾ ĐỘ TỐI (DARK MODE) */
/* Nút chuyển sang màu Trắng hoàn toàn để nổi trên nền tối */
body.dark-mode .invitation-card .btn,
[data-bs-theme="dark"] .invitation-card .btn,
[data-theme="dark"] .invitation-card .btn {
    color: #ffffff !important;
    border-color: #ffffff !important;
}

/* Hover ở chế độ tối */
body.dark-mode .invitation-card .btn:hover,
[data-bs-theme="dark"] .invitation-card .btn:hover,
[data-theme="dark"] .invitation-card .btn:hover {
    background-color: #ffffff !important;
    color: #000000 !important; /* Di chuột vào thì chữ đen nền trắng */
}

.invitation-card .text-muted {
  color: #777777 !important;
}

.invitation-card .border-secondary {
  border-color: #dcd6c8 !important;
}

/* 2. CHẾ ĐỘ TỐI (Dark Mode) - Nền Xám Tối, Chữ Trắng (Giống Hình 1) */
/* Code này sẽ kích hoạt khi body có class dark-mode hoặc thuộc tính dark */
body.dark-mode .invitation-card,
body.dark-version .invitation-card,
[data-bs-theme="dark"] .invitation-card,
[data-theme="dark"] .invitation-card {
  background-color: #26282b !important;
  /* Màu xám tối sang trọng */
  color: #ffffff !important;
  /* Chữ trắng */
  border: 1px solid #444444 !important;
  /* Viền tối */
  box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5) !important;
  /* Bóng đổ đậm hơn */
}

/* Ép các thành phần con đổi màu theo nền */
body.dark-mode .invitation-card h1,
body.dark-mode .invitation-card h2,
body.dark-mode .invitation-card h3,
body.dark-mode .invitation-card h5,
body.dark-mode .invitation-card strong,
body.dark-mode .invitation-card span,
/* Và các biến thể khác */
[data-bs-theme="dark"] .invitation-card h2,
[data-bs-theme="dark"] .invitation-card span {
  color: #ffffff !important;
}

body.dark-mode .invitation-card .text-muted,
[data-bs-theme="dark"] .invitation-card .text-muted {
  color: #adb5bd !important;
  /* Màu xám sáng cho chữ phụ */
}

body.dark-mode .invitation-card .border-secondary,
[data-bs-theme="dark"] .invitation-card .border-secondary {
  border-color: #495057 !important;
}

/* Màu đỏ chủ đạo (Indianred) vẫn giữ nguyên hoặc sáng hơn xíu ở chế độ tối */
.text-indianred {
  color: indianred !important;
}

/* --- DRESS CODE STYLES --- */
.color-swatch {
  width: 3.5rem;
  height: 3.5rem;
  border-radius: 50%;
  border: 3px solid #fff;
  /* Viền trắng tạo độ nổi */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease;
  cursor: pointer;
  position: relative;
}

.color-swatch:hover {
  transform: translateY(-5px) scale(1.1);
  /* Hiệu ứng bay lên khi di chuột */
  z-index: 10;
}

.color-name {
  font-size: 0.75rem;
  margin-top: 5px;
  font-weight: 600;
  color: #666;
  display: block;
  line-height: 1.2;
}

/* --- STYLE CHO DRESS CODE KHÔNG CARD --- */

/* Mặc định (Chế độ sáng) */
.color-name {
    font-weight: 600;
    color: #555;
    transition: color 0.3s;
}

/* Chế độ tối (Dark Mode) - Đổi màu chữ sang trắng */
body.dark-mode .color-name,
body.dark-mode p, /* Các đoạn văn bản nằm ngoài card */
[data-bs-theme="dark"] .color-name,
[data-bs-theme="dark"] p {
    color: #e0e0e0 !important;
}

body.dark-mode .text-muted,
[data-bs-theme="dark"] .text-muted {
    color: #aaa !important;
}

/* Hiệu ứng Color Swatch khi không có card */
.color-item {
    transition: transform 0.3s;
}
.color-item:hover {
    transform: translateY(-5px);
}

/* --- PHONG CÁCH "WAX SEAL STATIONERY" (THƯ TAY CÓ CON DẤU) --- */

/* --- PHONG CÁCH "WAX SEAL STATIONERY" (THƯ TAY) --- */

/* 1. GIAO DIỆN SÁNG (MẶC ĐỊNH) */
.gift-stationery {
    position: relative;
    background-color: #fff5f5; /* Nền hồng phấn nhạt */
    padding: 3rem 1.5rem 2rem 1.5rem;
    margin-top: 2rem;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    transition: transform 0.3s ease, background-color 0.3s ease;
}

/* Viền nét đứt bên trong */
.gift-stationery::before {
    content: '';
    position: absolute;
    top: 10px; left: 10px; right: 10px; bottom: 10px;
    border: 1px dashed indianred;
    border-radius: 8px;
    pointer-events: none;
    opacity: 0.5;
}

/* Con dấu sáp */
.wax-seal {
    position: absolute;
    top: -25px; left: 50%;
    transform: translateX(-50%);
    width: 50px; height: 50px;
    background-color: #A52A2A;
    border-radius: 50%;
    border: 3px solid #fff;
    box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    display: flex; align-items: center; justify-content: center;
    color: #ffd700; font-size: 1.2rem; z-index: 10;
}
.wax-seal::after {
    content: ''; position: absolute;
    top: 2px; left: 2px; right: 2px; bottom: 2px;
    border: 1px solid rgba(255,255,255,0.3); border-radius: 50%;
}

.gift-stationery:hover { transform: translateY(-5px); }


/* 2. GIAO DIỆN TỐI (DARK MODE - FIX LỖI MÀU XẤU & CHỮ CHÌM) */
body.dark-mode .gift-stationery,
[data-bs-theme="dark"] .gift-stationery {
    /* Đổi nền sang màu Xám Đen (Black Luxury) thay vì Đỏ nâu */
    background-color: #212529 !important; 
    border: 1px solid #444; /* Viền nhẹ để tách biệt với nền body */
    box-shadow: 0 10px 20px rgba(0,0,0,0.5);
}

/* Đổi màu viền nét đứt sang màu Vàng Kim cho sang */
body.dark-mode .gift-stationery::before,
[data-bs-theme="dark"] .gift-stationery::before {
    border-color: #ffd700 !important;
    opacity: 0.3;
}

/* Viền con dấu đổi sang màu trùng nền tối */
body.dark-mode .wax-seal,
[data-bs-theme="dark"] .wax-seal {
    border-color: #212529 !important;
}

/* --- QUAN TRỌNG: ÉP MÀU CHỮ TRẮNG --- */

/* Tên Cô dâu / Chú rể */
body.dark-mode .gift-stationery h4,
[data-bs-theme="dark"] .gift-stationery h4 {
    color: #ffd700 !important; /* Tên màu vàng kim nổi bật */
}

/* Các chữ phụ (text-muted) chuyển sang trắng mờ */
body.dark-mode .gift-stationery .text-muted,
[data-bs-theme="dark"] .gift-stationery .text-muted,
body.dark-mode .gift-stationery p,
[data-bs-theme="dark"] .gift-stationery p {
    color: #cccccc !important;
}

/* SỐ TÀI KHOẢN (Fix lỗi bị xám) */
body.dark-mode .gift-stationery .fs-5,
[data-bs-theme="dark"] .gift-stationery .fs-5 {
    color: #ffffff !important; /* Số tài khoản trắng tinh */
}

/* Nút Copy */
body.dark-mode .gift-stationery .btn-link,
[data-bs-theme="dark"] .gift-stationery .btn-link {
    color: #ffd700 !important; /* Icon copy màu vàng */
}

/* Tùy chỉnh Navbar Bottom */
#navbar-menu {
    /* Hiệu ứng kính mờ (Glassmorphism) nhìn cho sang */
    background-color: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(10px); 
    border-top: 1px solid rgba(0,0,0,0.05) !important;
}

/* Chế độ tối cho Navbar */
body.dark-mode #navbar-menu,
[data-bs-theme="dark"] #navbar-menu {
    background-color: rgba(33, 37, 41, 0.95) !important;
    border-top: 1px solid rgba(255,255,255,0.1) !important;
}

/* Màu icon khi chưa bấm */
#navbar-menu .nav-link {
    color: #999 !important;
    transition: color 0.3s;
}

/* Màu icon khi đang Active hoặc Hover (Màu chủ đạo) */
#navbar-menu .nav-link:hover,
#navbar-menu .nav-link.active {
    color: indianred !important;
}

/* --- FIX LỖI TRÀN MÀN HÌNH TRÊN MOBILE --- */
html, body {
    max-width: 100% !important;
    position: relative; /* Giữ vị trí chuẩn */
}

section {
    overflow-x: hidden; /* Đảm bảo từng section không bị tràn */
}

/* --- TÙY CHỈNH THANH CUỘN (SCROLLBAR) --- */
/* Chỉ áp dụng cho Webkit (Chrome, Edge, Safari...) */

::-webkit-scrollbar {
    width: 6px; /* Chiều ngang thanh cuộn dọc */
    height: 6px; /* Chiều cao thanh cuộn ngang */
}

/* Phần nền (Track) */
::-webkit-scrollbar-track {
    background: #f1f1f1; 
    border-radius: 4px;
}

/* Phần thanh trượt (Thumb) */
::-webkit-scrollbar-thumb {
    background: indianred; /* Màu chủ đạo của bạn */
    border-radius: 4px;
    transition: background 0.3s;
}

/* Khi di chuột vào thanh trượt */
::-webkit-scrollbar-thumb:hover {
    background: #c04e4e; /* Màu đậm hơn chút */
}

/* Ẩn thanh cuộn trên Mobile nhưng vẫn cuộn được (Cho gọn) */
@media (max-width: 768px) {
    ::-webkit-scrollbar {
        width: 0px;
        background: transparent;
    }
}

/* Hiệu ứng hiện dần */
@keyframes fadeInSmooth {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.fade-in-enter {
    animation: fadeInSmooth 1s ease-out forwards;
}

/* --- PH

/* 2. Hiệu ứng Sách Thật (Book Container) */
.stf__wrapper {
    /* Tạo bóng đổ lớn xuống nền để sách trông như đang nổi lên */
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8) !important;
    perspective: 2000px;
}

/* 3. Trang giấy (Page) */
.my-page {
    background-color: #fff; /* Màu giấy trắng */
    border-right: 1px solid #ddd; /* Viền trang */
    overflow: hidden;
}

/* --- QUAN TRỌNG: TẠO HIỆU ỨNG CONG GÁY SÁCH (SHADOW GRADIENT) --- */

/* Bóng đổ cho trang bên TRÁI (Tối ở mép phải - gáy sách) */
.my-page:nth-child(even)::after {
    content: "";
    position: absolute;
    top: 0; right: 0; bottom: 0;
    width: 40px; /* Độ rộng vùng bóng tối */
    background: linear-gradient(to left, rgba(0,0,0,0.25) 0%, rgba(0,0,0,0) 100%);
    pointer-events: none;
    z-index: 10;
}

/* Bóng đổ cho trang bên PHẢI (Tối ở mép trái - gáy sách) */
.my-page:nth-child(odd)::after {
    content: "";
    position: absolute;
    top: 0; left: 0; bottom: 0;
    width: 40px;
    background: linear-gradient(to right, rgba(0,0,0,0.25) 0%, rgba(0,0,0,0) 100%);
    pointer-events: none;
    z-index: 10;
}

/* 4. Style cho dòng hướng dẫn (Nhỏ gọn, tinh tế hơn) */
#flip-instructions {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 30px;
    padding: 8px 20px;
    color: #fff;
    font-size: 0.9rem;
    font-weight: 500;
    backdrop-filter: blur(5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

/* 5. Nút đóng (X) */
#btn-close-detail2 {
    background: rgba(255, 255, 255, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    transition: all 0.3s;
}
#btn-close-detail2:hover {
    background: #dc3545; /* Màu đỏ khi hover */
    border-color: #dc3545;
    transform: rotate(90deg);
}

/* Animation nhẹ cho mũi tên */
.instruction-arrow i {
    animation: sideMove 1.5s infinite ease-in-out;
}
@keyframes sideMove {
    0%, 100% { transform: translateX(0); opacity: 0.5; }
    50% { transform: translateX(3px); opacity: 1; }
}

/* --- FIX LỖI CUỘN LOVE STORY --- */
#storyTimelineModal {
    /* Luôn cho phép cuộn dọc */
    overflow-y: auto !important; 
    -webkit-overflow-scrolling: touch; /* Mượt mà trên iOS */
    
    /* Đảm bảo nó nằm trên cùng nhưng dưới Video Player */
    z-index: 9990; 
}

/* Khi Video Player hiện lên, Love Story tạm thời không cuộn để tránh rối */
body.video-active #storyTimelineModal {
    overflow: hidden !important; 
}

/* Đảm bảo Body bị khóa chặt khi Modal mở */
body.modal-open {
    overflow: hidden !important;
    height: 100vh;
}